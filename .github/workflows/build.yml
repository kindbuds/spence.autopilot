   name: Build and Release

   on:
     push:
       tags:
         - 'v*.*.*'

   jobs:
     build:
       runs-on: macos-latest

       env:
         ACTIONS_ALLOW_USE_UNSECURE_NODE_VERSION: true

       steps:
         - name: Checkout code
           uses: actions/checkout@v4

         - name: List directory contents
           run: ls -R

         - name: Set up Node.js
           uses: actions/setup-node@v4
           with:
             node-version: '18'

         - name: Install dependencies
           run: |
             cd electron
             npm install

         - name: Debug Node.js version and npm
           run: |
             cd electron
             node -v
             npm -v

         - name: Build Electron app
           run: |
             cd electron
             npm run make

         - name: Upload artifact
           uses: actions/upload-artifact@v3
           with:
             name: macos-build
             path: electron/out/make/zip/darwin/x64/*.zip

     release:
       needs: build
       runs-on: macos-latest

       env:
         ACTIONS_ALLOW_USE_UNSECURE_NODE_VERSION: true

       steps:
         - name: Download artifact
           uses: actions/download-artifact@v3
           with:
             name: macos-build
             path: ./dist

         - name: Create Release
           uses: softprops/action-gh-release@v1
           with:
             files: ./dist/*.zip
           env:
             GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
